需要访问移动设备，没有提供相关步骤
日志路径固定
敏感信息有明显特征，可以通过关键词定位；敏感信息是明文，不需要解码

攻击方式：需要访问系统，还需要一定的Android开发知识才可以利用漏洞

9.2	Coolpad Canvas – Write Logcat log, Kernel log, and tcpdump Capture to the SD Card

The Coolpad Canvas Android device35 is sold by Cricket Wireless and contains a vulnerable version of the com.qualcomm.qti.modemtestmode (versionCode=24, versionName=7.0) app, allowing third-party apps to change certain system properties (as explained in Section 9) . The build fingerprint of the device is Coolpad/cp3636a/cp3636a:7.0/NRD90M/093031423:user/release-keys. Setting a system property can enable logging features on the device that would not otherwise be unavailable to a third-party app. Specifically, using the method described above, any app can set the persist.service.logr.enable property to a value of 1 to enable logging on the device. When this occurs, the device will start writing log files to a path of /sdcard/log. Below is a listing of the files created in the /sdcard/log directory.

cp3636a:/sdcard/log $ ls -al total 1984
drwxrwx--x 2 root sdcard_rw  4096 2018-05-18 11:42 .
drwxrwx--x 15 root sdcard_rw  4096 2018-05-18 01:30 ..
-rw-rw---- 1 root sdcard_rw   632 2018-05-18 11:48 0518114248.crash.txt
-rw-rw---- 1 root sdcard_rw 157544 2018-05-18 11:48 0518114248.events.txt
-rw-rw---- 1 root sdcard_rw 241356 2018-05-18 11:48 0518114248.kernel.txt
-rw-rw---- 1 root sdcard_rw 261513 2018-05-18 11:48 0518114248.main.txt
-rw-rw---- 1 root sdcard_rw 65536 2018-05-18 11:47 0518114248.net.pcap
-rw-rw---- 1 root sdcard_rw    11 2018-05-18 11:42 0518114248.qsee.txt
-rw-rw---- 1 root sdcard_rw 244923 2018-05-18 11:48 0518114248.radio.txt
-rw-rw---- 1 root sdcard_rw 28089 2018-05-18 11:48 0518114248.system.txt

Five of the files correspond to the different log buffers (crash, events, radio, system, and main). These files are highlighted in orange. Android prevents third-party apps from reading directly from the system-wide logcat log since it tends to contain sensitive data. The kernel log is highlighted in purple. A network package capture (pcap) file is also highlighted in green. The qsee file, highlighted in blue contains a log for when logging starts. Therefore, any app with the READ_EXTERNAL_STORAGE permission can enable the logging to the SD card and read the log files.

When the persist.service.logr.enable system property is set to a value of 1 when the device finishes booting, an app with a package name of com.yulong.logredirect (versionCode=20160622, versionName=5.25_20160622_01) will create a sticky notification.  If the setting of the persist.service.logr.enable system property to a value of 1 happens after the boot process has completed, then notification will not be created by the com.yulong.logredirect app. Therefore, to keep the notification from appearing, the attacking app will have to set the persist.service.logr.enable system property to a value of 0 prior to the device being shut down or rebooted. To accomplish this the app needs to dynamically-register a broadcast receiver that listens for the action of android.intent.action.ACTION_SHUTDOWN. Once this broadcast is received, the app will use an already


35 https://www.cricketwireless.com/support/devices-and-accessories/coolpad-canvas-device-support/customer/device- support.html
 

existing object that extends the ServiceConnection interface to quickly interact with the MbnTestService bound service to quickly change the persist.service.logr.enable system property to a value of 0. Then when the device boots back up again, the notification will not be on and the attacking app can listen for various broadcast intents through a statically declared broadcast receiver app component in the attacking app’s AndroidManifest.xml file. This unburdens the attack app of also having to request the RECEIVE_BOOT_COMPLETED permission. For example, the app can statically register for the following broadcast actions: android.intent.action.SIM_STATE_CHANGED and org.codeaurora.intent.action.ACTION_NETWORK_SPECIFIER_SET. Interacting with the com.qualcomm.qti.modemtestmode app to change system properties is done in the same way as in Appendix G for the Vivo V7 device, except the Coolpad Canvas device uses an interface token name of com.qualcomm.qti.modemtestmode.IMbnTestService instead of com.qualcomm.qti.modemtestmode.f that is used for the Vivo V7. Other than this, the code to interact with the bound services is the same where the attacking app provides the appropriate key-value pair to modify system properties.

9.3	Coolpad Canvas – Leaking Telephony Data to the Logcat Log Vulnerability

The previous vulnerability (i.e., activating the logcat logs) allows any third-party app with the READ_EXTERNAL_STORAGE permission to read various log files including the logcat log. The standard Android Open Source Project (AOSP) code for the com.android.phone app does not write Short Message Service (SMS) messages to the Android log.

The com.android.phone app writes the user’s sent text messages to the logcat log.

05-18 16:33:19.165	1735	2120 E mzq	: table =smsvalues =address=(703) 555-1234 creator=com.android.mms thread_id=1 sub_id=1 read=1 date=1526675599134 body=huba subject=null priority=-1 type=6

The system_server process writes the outgoing calls to the logcat log.

05-18 16:38:53.565	1173	1173 I Telecom : Class:	processOutgoingCallIntent handle = tel:1%20800-864-8331,scheme = tel, uriString = 1 800-864-8331, isSkipSchemaParsing = false, isAddParticipant = false: PCR.oR@AJU
